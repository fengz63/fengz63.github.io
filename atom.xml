<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Feng&#39;s Tech Blogs</title>
  
  <subtitle>ä»£ç ä¸ç”Ÿæ´»</subtitle>
  <link href="http://zfeng.github.io/atom.xml" rel="self"/>
  
  <link href="http://zfeng.github.io/"/>
  <updated>2025-08-22T12:54:28.427Z</updated>
  <id>http://zfeng.github.io/</id>
  
  <author>
    <name>fengcode</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>client-go æºç è§£è¯»ï¼ˆäºŒï¼‰List and Watchæœºåˆ¶</title>
    <link href="http://zfeng.github.io/article/ffd9098a39e7/"/>
    <id>http://zfeng.github.io/article/ffd9098a39e7/</id>
    <published>2025-08-21T21:37:33.000Z</published>
    <updated>2025-08-22T12:54:28.427Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-èƒŒæ™¯"><a href="#1-èƒŒæ™¯" class="headerlink" title="1. èƒŒæ™¯"></a>1. èƒŒæ™¯</h2><p>Kubernetes ä¸­æ‰€æœ‰çš„APIå¯¹è±¡éƒ½æ˜¯å­˜å‚¨åœ¨Etcdä¸­ï¼Œä¸”åªèƒ½é€šè¿‡kube-apiserverè®¿é—®ã€‚å½“è®¿é—®é‡å¾ˆå¤§æ—¶ï¼Œkube-apiserverä¼šä¸å ªé‡è´Ÿã€‚</p><p>åŸºäºä¸Šè¿°è€ƒè™‘ï¼Œkubernetes ä¸­å¼•å…¥äº†ä¸€ä¸ªInformeræœºåˆ¶ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªé«˜æ•ˆçš„ç¼“å­˜ï¼Œå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚éƒ½å¯ä»¥é€šè¿‡ç¼“å­˜å®ç°ï¼Œè€Œä¸å¿…å…¨éƒ¨ç©¿é€åˆ°kube-apiserverã€‚</p><span id="more"></span><p>Kuberneteså®ç°è¿™ä¸€é«˜æ•ˆç¼“å­˜çš„æ ¸å¿ƒå°±æ˜¯ list å’Œ watchæœºåˆ¶ã€‚åœ¨ Informer å¯åŠ¨æ—¶å…ˆæ‰§è¡Œ List() æ“ä½œï¼Œä»è€Œè·å–Etcdä¸­å…¨é‡èµ„æºï¼Œå¹¶ç¼“å­˜åˆ°æœ¬åœ°ï¼›ä¹‹å Informer å¯åŠ¨ Watch() æ“ä½œï¼Œé€šè¿‡ä¸kube-apiserverçš„é•¿è¿æ¥æ¥æŒç»­æ¥æ”¶æŒ‡å®šèµ„æºçš„åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤äº‹ä»¶ã€‚è¿™æ„æˆäº†ä¸€ä¸ªå‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œå®¢æˆ·ç«¯é€šè¿‡Listæ“ä½œè·å–å½“å‰çŠ¶æ€åï¼Œå†å‘èµ·Watchè¯·æ±‚æ¥è®¢é˜…åç»­å˜æ›´ã€‚è¿™ç§æœºåˆ¶å¯ä»¥é¿å…å®¢æˆ·ç«¯åå¤çš„ List æ“ä½œçš„å¼€é”€ï¼Œå¤§å¤§æé«˜äº†æ•ˆç‡ï¼Œé™ä½kube-apiserverçš„è´Ÿè½½ã€‚</p><h2 id="2-ListerWatcher"><a href="#2-ListerWatcher" class="headerlink" title="2. ListerWatcher"></a>2. ListerWatcher</h2><p>ListerWatcher æ˜¯ lister å’Œ watcher çš„ç»“åˆä½“ï¼Œå‰è€…è´Ÿè´£åˆ—ä¸¾å…¨é‡å¯¹è±¡ï¼Œåè€…è´Ÿè´£ç›‘è§†å¯¹è±¡çš„å¢é‡å˜åŒ–ã€‚ä½œä¸º Reflector çš„ä¸€ä¸ªä¸»è¦èƒ½åŠ›æä¾›è€…ï¼ŒListerWatcher åœ¨kubernetesä¸­å‘æŒ¥äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p><h3 id="2-1-ListerWatcher-å¯¹è±¡çš„åˆ›å»º"><a href="#2-1-ListerWatcher-å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="2.1 ListerWatcher å¯¹è±¡çš„åˆ›å»º"></a>2.1 ListerWatcher å¯¹è±¡çš„åˆ›å»º</h3><p>ListerWatcherå¯¹åº”çš„å¿ƒé—´å®ä¾‹å‡½æ•°å¦‚ä¸‹ï¼ˆä»£ç è§ï¼š<a href="https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/client-go/tools/cache/listwatch.go">listwatch.go</a>ï¼‰ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewListWatchFromClient</span><span class="params">(c Getter, resource <span class="type">string</span>, namespace <span class="type">string</span>, fieldSelector fields.Selector)</span></span> *ListWatch &#123;</span><br><span class="line">optionsModifier := <span class="function"><span class="keyword">func</span><span class="params">(options *metav1.ListOptions)</span></span> &#123;</span><br><span class="line">options.FieldSelector = fieldSelector.String()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> NewFilteredListWatchFromClient(c, resource, namespace, optionsModifier)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸»è¦é€»è¾‘è§ä¸‹é¢å‡½æ•°ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewFilteredListWatchFromClient</span><span class="params">(c Getter, resource <span class="type">string</span>, namespace <span class="type">string</span>, optionsModifier <span class="keyword">func</span>(options *metav1.ListOptions)</span></span>) *ListWatch &#123;</span><br><span class="line">listFunc := <span class="function"><span class="keyword">func</span><span class="params">(options metav1.ListOptions)</span></span> (runtime.Object, <span class="type">error</span>) &#123;</span><br><span class="line">optionsModifier(&amp;options)</span><br><span class="line"><span class="keyword">return</span> c.Get().</span><br><span class="line">Namespace(namespace).</span><br><span class="line">Resource(resource).</span><br><span class="line">VersionedParams(&amp;options, metav1.ParameterCodec).</span><br><span class="line">Do(context.Background()).</span><br><span class="line">Get()</span><br><span class="line">&#125;</span><br><span class="line">watchFunc := <span class="function"><span class="keyword">func</span><span class="params">(options metav1.ListOptions)</span></span> (watch.Interface, <span class="type">error</span>) &#123;</span><br><span class="line">options.Watch = <span class="literal">true</span></span><br><span class="line">optionsModifier(&amp;options)</span><br><span class="line"><span class="keyword">return</span> c.Get().</span><br><span class="line">Namespace(namespace).</span><br><span class="line">Resource(resource).</span><br><span class="line">VersionedParams(&amp;options, metav1.ParameterCodec).</span><br><span class="line">Watch(context.Background())</span><br><span class="line">&#125;</span><br><span class="line">listFuncWithContext := <span class="function"><span class="keyword">func</span><span class="params">(ctx context.Context, options metav1.ListOptions)</span></span> (runtime.Object, <span class="type">error</span>) &#123;</span><br><span class="line">optionsModifier(&amp;options)</span><br><span class="line"><span class="keyword">return</span> c.Get().</span><br><span class="line">Namespace(namespace).</span><br><span class="line">Resource(resource).</span><br><span class="line">VersionedParams(&amp;options, metav1.ParameterCodec).</span><br><span class="line">Do(ctx).</span><br><span class="line">Get()</span><br><span class="line">&#125;</span><br><span class="line">watchFuncWithContext := <span class="function"><span class="keyword">func</span><span class="params">(ctx context.Context, options metav1.ListOptions)</span></span> (watch.Interface, <span class="type">error</span>) &#123;</span><br><span class="line">options.Watch = <span class="literal">true</span></span><br><span class="line">optionsModifier(&amp;options)</span><br><span class="line"><span class="keyword">return</span> c.Get().</span><br><span class="line">Namespace(namespace).</span><br><span class="line">Resource(resource).</span><br><span class="line">VersionedParams(&amp;options, metav1.ParameterCodec).</span><br><span class="line">Watch(ctx)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> &amp;ListWatch&#123;</span><br><span class="line">ListFunc:             listFunc,</span><br><span class="line">WatchFunc:            watchFunc,</span><br><span class="line">ListWithContextFunc:  listFuncWithContext,</span><br><span class="line">WatchFuncWithContext: watchFuncWithContext,</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶æ ¸å¿ƒçš„ list å’Œ watch èƒ½åŠ›éƒ½æ˜¯é€šè¿‡ Getter æ¥æä¾›çš„ï¼Œè‡³äº Getter æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬æ¥ç€åˆ†æã€‚</p><p>Getter æ¥å£å®šä¹‰ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Getter <span class="keyword">interface</span> &#123;</span><br><span class="line">Get() *restclient.Request</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»è¿™é‡Œæˆ‘ä»¬èƒ½çœ‹å‡ºï¼ŒGetter æ¥å£çš„ Get()æ–¹æ³•è¿”å›çš„æ˜¯ *restclient.Request ç±»å‹ã€‚è‡³äº Request æ€ä¹ˆç”¨ç›´æ¥è§ ListWatch çš„ new å‡½æ•°å°±èƒ½çœ‹å‡ºã€‚ </p><p>æ‰€ä»¥è¿™é‡Œçš„newå‡½æ•°ä¸­çš„ c.Get() å…¶å®å°±æ˜¯ RESTClient.Get() æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ *rest.Requestå¯¹è±¡ã€‚</p><h3 id="2-2-Lister-å’Œ-Watcher-å®šä¹‰"><a href="#2-2-Lister-å’Œ-Watcher-å®šä¹‰" class="headerlink" title="2.2 Lister å’Œ Watcher å®šä¹‰"></a>2.2 Lister å’Œ Watcher å®šä¹‰</h3><p>æˆ‘ä»¬æ¥ç€åˆ†æ NewFilteredListWatchFromClient() å‡½æ•°ï¼Œå…¶ä¸­çš„æ ¸å¿ƒæ˜¯ ListFunc å’Œ WatchFunc</p><p>Lister å¯¹è±¡æ˜¯é€šè¿‡ä¸€ä¸ªæ¥å£æ¥å®šä¹‰çš„ï¼Œä»£ç è§ï¼š<a href="https://github.com/kubernetes/kubernetes/blob/master/staging/src/k8s.io/client-go/tools/cache/listwatch.go#L163">listwatch.go</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Lister <span class="keyword">interface</span> &#123;</span><br><span class="line"><span class="comment">// List çš„è¿”å›å€¼åº”è¯¥æ˜¯ä¸€ä¸ª list ç±»å‹å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯é‡Œé¢æœ‰ Items å­—æ®µï¼Œå…¶ä¸­çš„ resourceVersion å¯ä»¥ç”¨æ¥ watch</span></span><br><span class="line">List(options metav1.ListOptions) (runtime.Object, <span class="type">error</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Watcher <span class="keyword">interface</span> &#123;</span><br><span class="line"><span class="comment">// Watch åº”è¯¥ä»æŒ‡å®šçš„ç‰ˆæœ¬ï¼ˆå³ï¼šresourceVersionï¼‰å¼€å§‹ watch</span></span><br><span class="line">Watch(options metav1.ListOptions) (watch.Interface, <span class="type">error</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ListerWatcher <span class="keyword">interface</span> &#123;</span><br><span class="line">Lister</span><br><span class="line">Watcher</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° ListerWatcher çš„æ¥å£åŒ…æ‹¬äº† Lister å’Œ Watcher æ¥å£ã€‚</p><h3 id="2-3-List-å’Œ-Watch-çš„å®ç°"><a href="#2-3-List-å’Œ-Watch-çš„å®ç°" class="headerlink" title="2.3 List å’Œ Watch çš„å®ç°"></a>2.3 List å’Œ Watch çš„å®ç°</h3><p>æœ‰äº†å¯¹åº”çš„æ¥å£çš„å®šä¹‰åï¼ŒListå’ŒWatchå¯¹åº”çš„ä¸€ä¸ªå®ç°çš„ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ListWatch <span class="keyword">struct</span> &#123;</span><br><span class="line"><span class="comment">// è¿™é‡Œçš„ ListFunc å’Œ WatchFunc å·²ç»è¢«æ ‡è®°ä¸ºé‡å¤äº†ï¼Œååºåº”è¯¥ä¼šä¸»è¦ä½¿ç”¨ WithContext ç‰ˆæœ¬çš„ List å’Œ Watch</span></span><br><span class="line">ListFunc ListFunc</span><br><span class="line">WatchFunc WatchFunc</span><br><span class="line"></span><br><span class="line">ListWithContextFunc  ListWithContextFunc</span><br><span class="line">WatchFuncWithContext WatchFuncWithContext</span><br><span class="line"></span><br><span class="line"><span class="comment">// DisableChunking requests no chunking for this list watcher.</span></span><br><span class="line">DisableChunking <span class="type">bool</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ”¹ç»“æ„ä½“åˆ†åˆ«å®ç°äº† List(), Watch() ç­‰æ–¹æ³•ï¼Œè¿™é‡Œä»¥ List() æ–¹æ³•ä¸ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(lw *ListWatch)</span></span> List(options metav1.ListOptions) (runtime.Object, <span class="type">error</span>) &#123;</span><br><span class="line"><span class="comment">// ListWatch åœ¨ Reflector ä¸­å·²ä½¿ç”¨ï¼Œè€Œ Reflector å·²æ”¯æŒåˆ†é¡µï¼Œæ­¤å¤„æ— éœ€åˆ†é¡µï¼Œä»¥å…é‡å¤</span></span><br><span class="line"><span class="keyword">if</span> lw.ListFunc != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> lw.ListFunc(options)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> lw.ListWithContextFunc(context.Background(), options)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° List() æ–¹æ³•å…¶æœ¬è´¨å°±æ˜¯ï¼šä½äº New å‡½æ•°ä¸­çš„ï¼Œé€šè¿‡ client æ¥å‘èµ·çš„çš„ä¸€ä¸ªGETè¯·æ±‚ã€‚å…¶ä¸­ List å’Œ Watch ä¸ä¸€æ ·çš„ç‚¹åœ¨äºï¼ŒList æœ€åè°ƒç”¨äº† Do() æ–¹æ³•ï¼Œè€Œ Watch æœ€åè°ƒç”¨çš„æ˜¯ Watch() æ–¹æ³•ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;1-èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#1-èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;1. èƒŒæ™¯&quot;&gt;&lt;/a&gt;1. èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;Kubernetes ä¸­æ‰€æœ‰çš„APIå¯¹è±¡éƒ½æ˜¯å­˜å‚¨åœ¨Etcdä¸­ï¼Œä¸”åªèƒ½é€šè¿‡kube-apiserverè®¿é—®ã€‚å½“è®¿é—®é‡å¾ˆå¤§æ—¶ï¼Œkube-apiserverä¼šä¸å ªé‡è´Ÿã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºä¸Šè¿°è€ƒè™‘ï¼Œkubernetes ä¸­å¼•å…¥äº†ä¸€ä¸ªInformeræœºåˆ¶ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªé«˜æ•ˆçš„ç¼“å­˜ï¼Œå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚éƒ½å¯ä»¥é€šè¿‡ç¼“å­˜å®ç°ï¼Œè€Œä¸å¿…å…¨éƒ¨ç©¿é€åˆ°kube-apiserverã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æŠ€æœ¯" scheme="http://zfeng.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="æŠ€æœ¯" scheme="http://zfeng.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
    <category term="Kubernetesæºç è§£è¯»" scheme="http://zfeng.github.io/tags/Kubernetes%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>client-go æºç è§£è¯»ï¼ˆä¸€ï¼‰æ€»è¿°</title>
    <link href="http://zfeng.github.io/article/372617688925/"/>
    <id>http://zfeng.github.io/article/372617688925/</id>
    <published>2025-08-18T13:37:33.000Z</published>
    <updated>2025-08-22T12:56:54.679Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-èƒŒæ™¯"><a href="#1-èƒŒæ™¯" class="headerlink" title="1. èƒŒæ™¯"></a>1. èƒŒæ™¯</h2><p>æœ€è¿‘å·¥ä½œä¸­é¢‘ç¹ç”¨åˆ° Informerã€Controller ç­‰ç›¸å…³ç»„ä»¶ï¼Œä»¥åŠ Listã€Watch ç­‰ APIï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£å…¶å·¥ä½œåŸç†ï¼Œå†³å®šå¯¹ client-go æºç è¿›è¡Œè¯¦ç»†è§£è¯»ã€‚</p><span id="more"></span><h2 id="2-client-go-æ¶æ„"><a href="#2-client-go-æ¶æ„" class="headerlink" title="2. client-go æ¶æ„"></a>2. client-go æ¶æ„</h2><p>åœ¨å¼€å§‹æºç è§£è¯»ä¹‹å‰ï¼Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹ client-go ä¸€äº›ç›¸å…³çš„ç»“æ„ï¼Œç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/2025/08/18/18210845.jpeg"></p><p>æ•´ä¸ªæ¶æ„å›¾åˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸ŠåŠéƒ¨åˆ†ä¸º client-go çš„å®ç°ï¼Œè€Œä¸‹åŠéƒ¨åˆ†æ˜¯æˆ‘ä»¬è‡ªå·±è¦å®ç°çš„ custom controllerï¼Œæ¯éƒ¨åˆ†ç”±ä¸åŒçš„ç»„ä»¶ç»„æˆï¼Œä¸Šä¸‹ä¸¤éƒ¨åˆ†é€šè¿‡è™šçº¿è¿æ¥èµ·æ¥ã€‚æˆ‘ä»¬ç€é‡ä»‹ç»ä¸‹ä¸ŠåŠéƒ¨åˆ†çš„ç»„ä»¶ï¼Œåç»­çš„æºç è§£è¯»ä¹Ÿæ˜¯åŸºäºä¸ŠåŠéƒ¨åˆ†æ¶æ„å›¾è¿›è¡Œçš„ã€‚</p><ul><li><strong>Reflector</strong>ï¼šé€šè¿‡ List&amp;Watch æœºåˆ¶ä» kube-apiserver è·å–èµ„æºå¯¹è±¡ï¼Œå¹¶æŠŠæ•°æ®æ”¾åˆ° Delta FIFO é˜Ÿåˆ—ä¸­ï¼›</li><li><strong>DeltaFIFO</strong>ï¼šDelta FIFO æ˜¯ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼Œç”¨äºå­˜å‚¨ Reflector ä» kube-apiserver è·å–åˆ°çš„èµ„æºå¯¹è±¡çš„å¢é‡å˜åŒ–</li><li><strong>Informer</strong>ï¼šInformer ä» DeltaFIFO ä¸­å–å‡ºç›¸åº”å¯¹è±¡ï¼Œç„¶åé€šè¿‡ Indexer å°†å¯¹è±¡å’Œç´¢å¼•ä¸¢åˆ°æ”¾å…¥ cache ä¸­ï¼Œå†è§¦å‘ç›¸åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼ˆResource Event Handlersï¼‰è¿è¡Œï¼›</li><li><strong>Indexer</strong>ï¼šä¸»è¦æä¾›ä¸€ä¸ªå¯¹è±¡æ ¹æ®ä¸€å®šæ¡ä»¶æ£€ç´¢çš„èƒ½åŠ›ï¼Œå…¸å‹çš„æ˜¯é€šè¿‡ namespace&#x2F;name æ¥æ„é€  keyï¼Œé€šè¿‡ ThreadSafeStore æ¥å­˜å‚¨å¯¹è±¡</li><li><strong>Workqueue</strong>ï¼šWorkqueue ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯å»¶æ—¶é˜Ÿåˆ—å®ç°ï¼Œåœ¨ Resource Event Handlers ä¸­ä¼šå®Œæˆå°†å¯¹è±¡çš„ key æ”¾å…¥ workqueue çš„è¿‡ç¨‹ï¼Œç„¶åæˆ‘ä»¬åœ¨è‡ªå·±çš„é€»è¾‘ä»£ç é‡Œä» workqueue ä¸­æ¶ˆè´¹è¿™äº› keyï¼ˆæ¶æ„å›¾ä¸‹åŠéƒ¨åˆ†ï¼‰ï¼›</li><li><strong>Resource Event Handlers</strong>ï¼šResource Event Handlers æ˜¯ Informer æ³¨å†Œçš„å›è°ƒå‡½æ•°ï¼Œå½“ Informer ä» DeltaFIFO ä¸­å–å‡ºå¯¹è±¡åï¼Œä¼šæ ¹æ®å¯¹è±¡çš„æ“ä½œç±»å‹ï¼ˆAdd&#x2F;Update&#x2F;Deleteï¼‰è°ƒç”¨å¯¹åº”çš„å›è°ƒå‡½æ•°ï¼›</li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;1-èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#1-èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;1. èƒŒæ™¯&quot;&gt;&lt;/a&gt;1. èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;æœ€è¿‘å·¥ä½œä¸­é¢‘ç¹ç”¨åˆ° Informerã€Controller ç­‰ç›¸å…³ç»„ä»¶ï¼Œä»¥åŠ Listã€Watch ç­‰ APIï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£å…¶å·¥ä½œåŸç†ï¼Œå†³å®šå¯¹ client-go æºç è¿›è¡Œè¯¦ç»†è§£è¯»ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æŠ€æœ¯" scheme="http://zfeng.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="æŠ€æœ¯" scheme="http://zfeng.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
    <category term="Kubernetesæºç è§£è¯»" scheme="http://zfeng.github.io/tags/Kubernetes%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>å¤•é˜³</title>
    <link href="http://zfeng.github.io/article/b52011779fe6/"/>
    <id>http://zfeng.github.io/article/b52011779fe6/</id>
    <published>2025-08-15T12:53:28.000Z</published>
    <updated>2025-08-21T14:30:38.275Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ğŸŒ‡-ä»Šæ—¥æš®è‰²"><a href="#ğŸŒ‡-ä»Šæ—¥æš®è‰²" class="headerlink" title="ğŸŒ‡ ä»Šæ—¥æš®è‰²"></a>ğŸŒ‡ ä»Šæ—¥æš®è‰²</h2><p>å‘¨äº”çš„å¤•é˜³æ€»å¸¦ç€ç‰¹åˆ«çš„æ¸©æŸ”ï¼Œ18:00å‡†æ—¶åˆä¸Šç”µè„‘å‰å¾€é¤å…ï¼Œåœ¨è¿™ä¸ªéš¾å¾—çš„å‡†æ—¶ä¸‹ç­çš„æ—¥å­ï¼Œæˆ‘ååœ¨é¤å…é‡Œåƒç€æ™šé¤ï¼Œçœ‹ç€çª—å¤–çš„å¤©ç©ºä»ç™½è‰²æ…¢æ…¢å˜æˆäº†çº¢è‰²ï¼Œå¤•é˜³çš„ä½™æ™–åœ¨æˆ‘çš„è„‘æµ·ä¸­ç•™ä¸‹äº†ä¸€ä¸ªç¾å¥½çš„è®°å¿†ã€‚</p><span id="more"></span><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/2025/08/16/16170800.jpg"></p><p>è¸©ç€å¤•é˜³ä¸‹ç­çš„æ„Ÿè§‰éå¸¸å¥½ï¼</p><h2 id="ğŸŒƒ-å‰å¤œéšæ‹"><a href="#ğŸŒƒ-å‰å¤œéšæ‹" class="headerlink" title="ğŸŒƒ å‰å¤œéšæ‹"></a>ğŸŒƒ å‰å¤œéšæ‹</h2><p>å‰å¤œåŠ ç­æ—¶å¶ç„¶æ’è§çš„æƒŠå–œâ€“å…¬å¸15æ¥¼é˜³å°çš„ç¯ç«é•¿å·ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/2025/08/16/16170804.jpg"></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;ğŸŒ‡-ä»Šæ—¥æš®è‰²&quot;&gt;&lt;a href=&quot;#ğŸŒ‡-ä»Šæ—¥æš®è‰²&quot; class=&quot;headerlink&quot; title=&quot;ğŸŒ‡ ä»Šæ—¥æš®è‰²&quot;&gt;&lt;/a&gt;ğŸŒ‡ ä»Šæ—¥æš®è‰²&lt;/h2&gt;&lt;p&gt;å‘¨äº”çš„å¤•é˜³æ€»å¸¦ç€ç‰¹åˆ«çš„æ¸©æŸ”ï¼Œ18:00å‡†æ—¶åˆä¸Šç”µè„‘å‰å¾€é¤å…ï¼Œåœ¨è¿™ä¸ªéš¾å¾—çš„å‡†æ—¶ä¸‹ç­çš„æ—¥å­ï¼Œæˆ‘ååœ¨é¤å…é‡Œåƒç€æ™šé¤ï¼Œçœ‹ç€çª—å¤–çš„å¤©ç©ºä»ç™½è‰²æ…¢æ…¢å˜æˆäº†çº¢è‰²ï¼Œå¤•é˜³çš„ä½™æ™–åœ¨æˆ‘çš„è„‘æµ·ä¸­ç•™ä¸‹äº†ä¸€ä¸ªç¾å¥½çš„è®°å¿†ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="ç”Ÿæ´»" scheme="http://zfeng.github.io/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="ç”Ÿæ´»" scheme="http://zfeng.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title>è´µå·ä¹‹è¡Œ</title>
    <link href="http://zfeng.github.io/article/6a6bae1e9eab/"/>
    <id>http://zfeng.github.io/article/6a6bae1e9eab/</id>
    <published>2025-08-13T13:46:20.000Z</published>
    <updated>2025-08-21T14:30:38.292Z</updated>
    
    <content type="html"><![CDATA[<p>2025.05.14-05.19è¶ç€æ¢å·¥ä½œä¸­é—´ä¼‘æ¯çš„é—´éš™ï¼Œå’Œæœ‹å‹ä¸€èµ·å»äº†æ¬¡è´µå·ï¼Œè¡Œç¨‹å…±è®¡äº”å¤©ã€‚è¿™çŸ­çŸ­å‡ å¤©çš„æ—¶é—´çœ‹åˆ°äº†ä¸å°‘çš„é£æ™¯ï¼Œä¹Ÿåƒåˆ°äº†å¾ˆå¤šçš„ç¾é£Ÿï¼Œæ˜¯ä»2022å¹´4æœˆä»½æ¯•ä¸šåå·¥ä½œä»¥æ¥æœ€è½»æ¾ã€ä¼‘æ¯çš„æœ€å¥½çš„ä¸€æ¬¡ã€‚</p><span id="more"></span><h2 id="è´µé˜³"><a href="#è´µé˜³" class="headerlink" title="è´µé˜³"></a>è´µé˜³</h2><h3 id="è´µé˜³ç¾é£Ÿ"><a href="#è´µé˜³ç¾é£Ÿ" class="headerlink" title="è´µé˜³ç¾é£Ÿ"></a>è´µé˜³ç¾é£Ÿ</h3><p>è´µé˜³çš„ç¾é£Ÿå°±åƒè¿™åº§åŸå¸‚çš„æ°”å€™ä¸€æ ·ï¼Œå¤šå˜åˆå¸¦ç‚¹æƒŠå–œã€‚æ—©æ™¨ä¸€ç¢—çƒ­æ°”è…¾è…¾çš„è‚ æ—ºé¢ï¼Œé…¸è¾£å¼€èƒƒï¼Œç¬é—´å”¤é†’å‘³è•¾ï¼Œè´µé˜³çš„ç³¯ç±³é¥­ä¹Ÿæ˜¯ä¸€ç»ï¼Œåœ¨è¡—å¤´å··å°¾çš„é’¢ç§å°æ‘Šå‰ï¼Œä½ ä¼šçœ‹åˆ°è€æ¿ç†Ÿç»ƒåœ°å°†ç³¯ç±³é“ºå¥½ï¼Œå†æ’’ä¸ŠèŠ±ç”Ÿç²‰ã€æŠ˜è€³æ ¹ã€è…Šè‚‰æœ«ï¼Œå·æˆä¸€ä»½é¦™ç³¯è½¯ç³¯çš„å°å¹¸ç¦ã€‚</p><p>ä¸­åˆå¯ä»¥æ¥ä»½ä¸å¨ƒå¨ƒï¼Œç”¨è–„è–„çš„ç±³çš®åŒ…ä¸Šå„ç§çˆ½è„†å°èœï¼Œå†æ·‹ä¸Šé…¸è¾£è˜¸æ°´ï¼Œé…¸å¾—èˆ’æœè¾£å¾—è¿‡ç˜¾ã€‚è´µé˜³äººæ°‘å¯¹äºåˆé¥­ä¸æ˜¯ç‰¹åˆ«çš„é‡è§†ï¼Œå‡ ä¸ªäººåœ¨æ²¡æœ‰æ‰“å¬æ¸…æ¥šçš„æƒ…å†µä¸‹å»æ‰¾çƒ¤é±¼åƒï¼Œç„¶è€Œåº—é“ºéƒ½æ²¡å¼€é—¨ï¼Œæœ€åè¿˜æ˜¯æœ¬åœ°çš„å‡ºç§Ÿè½¦å¸æœºå‘Šè¯‰æˆ‘ä»¬æœ¬åœ°äººä¸é‡è§†åˆé¥­ï¼ŒåŸºæœ¬éƒ½æ˜¯éšä¾¿åƒä¸€ç‚¹ï¼Œå¾ˆå¤šåº—é“ºéƒ½æ˜¯å‚æ™šæ‰å¼€é—¨ã€‚</p><p>æ™šé¥­å¯¹äºè´µé˜³äººæ¥è¯´æ˜¯éå¸¸çš„é‡è¦çš„ï¼Œå‚æ™šçš„å¤§è¡—å°å··åˆ™å¼¥æ¼«ç€çƒ¤é±¼ã€è±†ç±³ç«é”…ä»¥åŠé…¸æ±¤ç«é”…çš„é¦™æ°”ï¼Œé²œé¦™éº»è¾£è®©äººåœä¸ä¸‹ç­·ã€‚æ— è®ºæ˜¯éšæ„çš„å°æ‘Šï¼Œè¿˜æ˜¯ç”¨å¿ƒçš„é¦†å­ï¼Œè´µé˜³çš„å‘³é“ï¼Œæ€»èƒ½è®©äººæ—¢æ»¡è¶³åˆå¿µå¿µä¸å¿˜</p><h3 id="è´µé˜³è¡—æ™¯"><a href="#è´µé˜³è¡—æ™¯" class="headerlink" title="è´µé˜³è¡—æ™¯"></a>è´µé˜³è¡—æ™¯</h3><p>è´µé˜³çš„è¡—æ™¯ä¹Ÿå……æ»¡äº†ç‰¹è‰²ï¼Œå¤è‰²å¤é¦™çš„ç”²ç§€æ¥¼æ˜ ç…§åœ¨æ¸…æ¾ˆçš„å—æ˜æ²³ä¸Šï¼Œå†å²æ„Ÿæ‰‘é¢è€Œæ¥ã€‚é’äº‘å¸‚é›†çš„çƒ­é—¹æ™¯è±¡æ‰‘é¢è€Œæ¥ï¼Œæ‘Šä½ä¸Šç³ç…æ»¡ç›®çš„è‹—ç»£ã€æ‰‹å·¥è‰ºå“å’Œåœ°æ–¹ç¾é£Ÿï¼Œè®©äººæ²‰æµ¸åœ¨æµ“éƒçš„æ°‘æ—é£æƒ…ä¹‹ä¸­ã€‚<br><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/scenery20250816133510521.jpg"></p><p>æ—©æ™¨çš„é»”çµå±±æ™¨é›¾ç¼­ç»•ï¼Œé’å±±å ç¿ ä¸ç°ä»£é«˜æ¥¼é¥ç›¸å‘¼åº”ã€‚å±•ç°å‡ºä¸€å¹…â€œå±±åœ¨åŸä¸­ã€åŸåœ¨å±±ä¸­â€çš„ç‹¬ç‰¹æ™¯è±¡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/scenery20250816132958521.jpg"></p><p>é»”çµå±±çš„åŠ¨ç‰©ä¹Ÿæå…·ç‰¹è‰²ï¼Œä¸€åªéå¸¸åƒæ˜¯ç†ŠçŒ«çš„ç‹—â€¦â€¦</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/scenery20250816135608141.JPG"></p><h2 id="è”æ³¢"><a href="#è”æ³¢" class="headerlink" title="è”æ³¢"></a>è”æ³¢</h2><p>è”æ³¢ï¼Œè¢«èª‰ä¸ºâ€œæ—æµ·ç§˜å¢ƒâ€ï¼Œæ˜¯ä¸€ç‰‡å……æ»¡åŸå§‹ç”Ÿæ€ç¾çš„å‡€åœŸã€‚è”æ³¢å°ä¸ƒå­”è¢«èª‰ä¸ºâ€œå¤©ç„¶ç”»å»Šâ€ï¼Œä»¥æ¸…æ¾ˆçš„æ¹–æ³Šã€å¥‡ç‰¹çš„å–€æ–¯ç‰¹åœ°è²Œå’ŒèŒ‚å¯†çš„åŸå§‹æ£®æ—é—»åã€‚ç„¶è€Œå¤©å…¬ä¸ä½œç¾ï¼Œäº”æœˆä»½çš„è´µå·ä¸€ç›´æ˜¯å¤šé›¨å¤©æ°”ï¼Œå»ä¹‹å‰æ­£å¥½è¿ç€ä¸‹äº†å¥½å‡ å¤©çš„é›¨ï¼Œå¯¼è‡´å°ä¸ƒå­”è¢«æ·¹ï¼Œæ°´ä¹Ÿéå¸¸æµ‘æµŠã€‚ä¸è¿‡åœ¨å¦ä¸€ä¸ªåœ°æ–¹çœ‹åˆ°äº†å®çŸ³ç»¿çš„é£æ™¯ï¼Œä¹Ÿç®—æ˜¯ä¸è™šæ­¤è¡Œã€‚<br><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/scenery20250816135725210.jpg"></p><h2 id="å®‰é¡º"><a href="#å®‰é¡º" class="headerlink" title="å®‰é¡º"></a>å®‰é¡º</h2><p>ç¬¬ä¸‰å¤©æˆ‘ä»¬æ¥åˆ°äº†å®‰é¡ºï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªå…¼å…·ç¾é£Ÿå’Œç¾æ™¯çš„åœ°æ–¹ã€‚è¿™é‡Œæœ‰æ°”åŠ¿ç£…ç¤´çš„é»„æœæ ‘ç€‘å¸ƒï¼Œæ°´æµå¦‚é“¶æ²³èˆ¬å¥”è…¾è€Œä¸‹ï¼Œæ¿€èµ·ä¸‡ä¸ˆæ°´é›¾ï¼Œéœ‡æ’¼äººå¿ƒ</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/scenery20250816140629955.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/scenery20250816140725302.jpg"></p><p>é™¤äº†ç¾æ™¯ï¼Œå®‰é¡ºçš„ç¾é£ŸåŒæ ·ä»¤äººéš¾å¿˜ï¼Œå¤ºå¤ºç²‰ç«é”…ã€å®‰é¡ºè£¹å·ä»¥åŠçƒ¤å°è‚ ç­‰ç‰¹è‰²ç¾é£Ÿè®©äººåƒä¸€æ¬¡å°±çƒ™åœ¨è®°å¿†é‡Œã€‚</p><p>18åº¦çš„å®‰é¡ºéå¸¸æ˜¯ä¸€ä¸ªéå¸¸é€‚åˆä¼‘é—²ä»¥åŠå“å°ç¾é£Ÿçš„å¥½åœ°æ–¹</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/scenery20250816141405227.jpg"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;2025.05.14-05.19è¶ç€æ¢å·¥ä½œä¸­é—´ä¼‘æ¯çš„é—´éš™ï¼Œå’Œæœ‹å‹ä¸€èµ·å»äº†æ¬¡è´µå·ï¼Œè¡Œç¨‹å…±è®¡äº”å¤©ã€‚è¿™çŸ­çŸ­å‡ å¤©çš„æ—¶é—´çœ‹åˆ°äº†ä¸å°‘çš„é£æ™¯ï¼Œä¹Ÿåƒåˆ°äº†å¾ˆå¤šçš„ç¾é£Ÿï¼Œæ˜¯ä»2022å¹´4æœˆä»½æ¯•ä¸šåå·¥ä½œä»¥æ¥æœ€è½»æ¾ã€ä¼‘æ¯çš„æœ€å¥½çš„ä¸€æ¬¡ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ—…è¡Œ" scheme="http://zfeng.github.io/categories/%E6%97%85%E8%A1%8C/"/>
    
    
    <category term="æ—…è¡Œ" scheme="http://zfeng.github.io/tags/%E6%97%85%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>è¥¿åŒ—å¤§ç¯çº¿</title>
    <link href="http://zfeng.github.io/article/37f945ceda60/"/>
    <id>http://zfeng.github.io/article/37f945ceda60/</id>
    <published>2025-08-12T09:05:33.000Z</published>
    <updated>2025-08-21T14:30:38.287Z</updated>
    
    <content type="html"><![CDATA[<p>2025å¹´çš„4æœˆä»½å¯¹æˆ‘æ¥è¯´æ˜¯å¼‚å¸¸è‰°éš¾çš„ï¼Œä¸ä»…è¦å®Œæˆå½“å‰çš„å·¥ä½œï¼Œè¿˜è¦é¡¶ç€å‹åŠ›å»é¢è¯•æ–°çš„å…¬å¸ã€‚ç„¶è€Œå¯èƒ½æ˜¯å› ä¸ºç¬¬ä¸€ä»½å·¥ä½œçš„æ–¹å‘è¿‡äºåº•å±‚ï¼Œå¾ˆå¤šå…¬å¸æ²¡æœ‰è¿™ä¸ªæ–¹å‘ï¼Œå¯¼è‡´æ‰¾å·¥ä½œå¼‚å¸¸è‰°è¾›ã€‚å‰åŠä¸ªæœˆåŸºæœ¬æ²¡æœ‰è¿›å…¥ç¬¬äºŒè½®é¢è¯•çš„ï¼Œéƒ½æ˜¯ä¸€è½®é¢è¯•å®Œå°±å¤±è´¥äº†ã€‚å¥½åœ¨æ²¡æœ‰è¢«æŒ«æŠ˜æ‰“è´¥ï¼ŒåšæŒä¸æ–­çš„å»å°è¯•æ–°å…¬å¸ï¼Œæ–°éƒ¨é—¨ï¼Œç»ˆäºåœ¨4æœˆåº•æ—¶å€™è¿æ¥äº†å¥½æ¶ˆæ¯ï¼Œé¾™èŠ¯ä¸­ç§‘å’Œå­—èŠ‚è·³åŠ¨å…ˆåæ‹¿åˆ°äº†æ„å‘ä¹¦ï¼Œç®—æ˜¯å¯ä»¥ç¨å¾®å–˜å£æ°”äº†ã€‚</p><span id="more"></span><p>æ‹¿åˆ°è‡ªå·±çš„æ„å‘ä¹¦åï¼Œæ­£å¥½åˆ°äº†äº”ä¸€å‡æœŸï¼Œäºæ˜¯è¶ç€è¿™æ®µæ—¶é—´å‡ ä¸ªäººå»äº†æœŸå¾…å·²ä¹…çš„è¥¿åŒ—å¤§ç¯çº¿ï¼Œå»æ„Ÿå—ä¸‹è¥¿åŒ—çš„é›„æµ‘å£®é˜”ã€‚</p><h2 id="Day1"><a href="#Day1" class="headerlink" title="Day1"></a>Day1</h2><p>5æœˆ1æ—¥å½“å¤©æˆ‘ä»¬é£æŠµè¥¿å®ï¼Œé£æœºå¿«è½åœ°æ—¶ï¼Œæ­£å¥½æ˜¯æ™šä¸Šï¼Œä»é£æœºèˆ·çª—ä¸Šæ‹åˆ°äº†é’æµ·å°åŸçš„å¤œæ™¯</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3862.jpg"></p><p>å…¥ä½çš„é…’åº—å‘¨å›´å°±æ˜¯ä¸€ä¸ªå¤œå¸‚ï¼Œè™½ç„¶å‡ºé—¨æ—¶å€™å·²ç»æ™šä¸Šåç‚¹äº†ï¼Œç„¶è€Œå¤œå¸‚ä¾ç„¶äººå¤´æ”’åŠ¨ã€‚ç‚•é”…ç¾Šæ’ã€è€é…¸å¥¶é’æµ·çš„ç‰¹è‰²ç¾é£Ÿæœç„¶åä¸è™šä¼ ã€‚</p><h2 id="Day2"><a href="#Day2" class="headerlink" title="Day2"></a>Day2</h2><p>ä»Šå¤©çš„è¡Œç¨‹å®‰æ’çš„æ¯”è¾ƒæ»¡ï¼Œä¸€å¤§æ—©å°±ä»è¥¿å®å‡ºå‘å‡ºå‘å‰å¾€é’æµ·æ¹–ï¼Œå°†è¿‘200kmçš„è·¯ç¨‹å¯¹æˆ‘ä»¬æ¥è¯´ä¹Ÿå°±æ˜¯çœ¨çœ¼ä¹‹é—´ã€‚ä¸€è·¯ä¸Šçš„ç¾æ™¯ä¹Ÿæ˜¯å¾ˆéœ‡æ’¼çš„ï¼Œé«˜åŸçš„å¤©éå¸¸çš„è“ï¼Œé›ªå±±è‹¥éšè‹¥ç°ï¼Œè¿™äº›å¯¹äºæˆ‘è¿™ä¸ªç¬¬ä¸€æ¬¡å»é«˜åŸçš„äººæ¥è¯´æ˜¯ååˆ†çš„æ–°å¥‡çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3869.jpg"></p><p>éšç€è·ç¦»é’æµ·æ¹–è¶Šæ¥è¶Šè¿‘ï¼Œæˆ‘ä»¬ä¼¼ä¹é—»åˆ°äº†ç©ºæ°”ä¸­æ¹–æ°´çš„å‘³é“ã€‚é»„è‰²çš„è§†é‡ä¸­çªç„¶å‡ºç°äº†ä¸€æ¡è“è‰²çš„çº¿ï¼Œæˆ‘ä»¬çŸ¥é“é’æµ·æ¹–åˆ°äº†ï¼Œé«˜åŸä¸Šçš„æ¹–ç¢§è“å¦‚æ´—ï¼Œä»¿ä½›ä¸€å—åµŒåœ¨ç¾¤å±±é—´çš„è“å®çŸ³ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3873.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3879.jpg"></p><p>é’æµ·æ¹–ç»“æŸåï¼Œä¸‹ä¸€ç«™æ˜¯èŒ¶å¡ç›æ¹–ï¼Œå¯¹äºè¿™ä¸ªç½‘ä¸Šè¯„ä»·æ¯èª‰å‚åŠçš„æ¹–ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ»¡æ€€æœŸå¾…çš„å»äº†ã€‚ç„¶è€Œå®é™…æƒ…å†µå´ä»¤æˆ‘ä»¬å¤§è·Œçœ¼é•œï¼Œå¯èƒ½æ˜¯å› ä¸ºå¤©æ°”ä¸å¤ªå¥½çš„ç¼˜æ•…ï¼Œæ¹–é¢å®Œå…¨æ²¡æœ‰ç½‘ä¸Šè¯´çš„å¤©ç©ºä¹‹é•œçš„æ ·å­ï¼Œå…¨æ˜¯æµ‘æµŠçš„æ°´ï¼Œè€Œä¸”æ”¶è´¹éå¸¸è´µï¼Œé—¨ç¥¨+å°ç«è½¦ç¥¨ä¸€å…±è¦168å…ƒï¼ŒçœŸæ˜¯ä»¤äººå¤§å¤±æ‰€æœ›ã€‚</p><h2 id="Day3"><a href="#Day3" class="headerlink" title="Day3"></a>Day3</h2><p>ç¬¬ä¸‰å¤©ï¼Œæˆ‘ä»¬çš„ä»å¾·ä»¤å“ˆå‡ºå‘å»å¾€å¤§æŸ´æ—¦å¯Ÿå°”æ±—ç›æ¹–ã€ç¿¡ç¿ æ¹–ã€‚è¯´å®è¯ç”±äºæ˜¨å¤©çš„èŒ¶å¡ç›æ¹–è¿œè¿œä½äºé¢„æœŸï¼Œæˆ‘ä¸ªäººå¯¹äºä»Šå¤©çš„è¡Œç¨‹å·²ç»ä¸æŠ±æœŸå¾…äº†ã€‚ç„¶è€Œä¸‡ä¸‡æ²¡æƒ³åˆ°çš„æ˜¯ï¼Œå¯Ÿå°”æ±—ç›æ¹–å´å‡ºäººæ„æ–™çš„æ¼‚äº®ã€‚æ•´ä¸ªæ¹–å¦‚åŒä¸€é¢æ— è¾¹çš„é•œå­ï¼Œç¢§ç»¿æ¾„æ¾ˆï¼Œå°†å¤©ç©ºä¸ç™½äº‘ä¸€å¹¶æ½å…¥æ€€ä¸­ã€‚<br><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3900.jpg"></p><h2 id="Day4-5"><a href="#Day4-5" class="headerlink" title="Day4&#x2F;5"></a>Day4&#x2F;5</h2><p>ç¬¬å››äº”ä¸¤å¤©æˆ‘ä»¬éƒ½å®‰æ’åœ¨äº†æ•¦ç…Œï¼Œè¿™åº§æˆç«‹äºæ±‰æ­¦å¸æ—¶æœŸçš„åŸå¸‚ï¼Œä½œä¸ºæ²³è¥¿å››éƒ¡ä¹‹ä¸€ï¼Œä¸ä»…æ˜¯å¤ä¸ç»¸ä¹‹è·¯ä¸Šçš„äº¤é€šè¦å¡ï¼Œæ›´æ˜¯ä¸œè¥¿æ–¹æ–‡æ˜äº¤æµçš„é‡è¦æ¢çº½ã€‚è¿™é‡Œæœ‰è¢«èª‰ä¸ºâ€œä¸œæ–¹è‰ºæœ¯æ˜ç â€çš„è«é«˜çªŸï¼Œå£ç”»ä¸é›•å¡‘æ‰¿è½½ç€åƒå¹´çš„å®—æ•™ä¿¡ä»°ä¸æ–‡åŒ–è®°å¿†ï¼›è¿™é‡Œä¹Ÿæœ‰é¸£æ²™å±±ä¸æœˆç‰™æ³‰çš„å¥‡è§‚ï¼Œè§è¯äº†å¤§æ¼ è’åŸä¸­çš„ç”Ÿå‘½å¥‡è¿¹ã€‚</p><p>è·¯ä¸Šè¿˜ç»è¿‡äº†é»‘ç‹¬å±±ï¼Œè¿œè¿œæœ›å»ï¼Œç¾¤å±±æ¼†é»‘å¦‚å¢¨ï¼Œèµ·ä¼çš„å±±è„Šçº¿åœ¨å¤©å…‰æ˜ ç…§ä¸‹æ˜¾å¾—æ ¼å¤–å†·å³»ã€‚è’å‡‰çš„æˆˆå£ä¸é»‘è‰²å±±ä½“äº¤ç»‡åœ¨ä¸€èµ·ï¼Œä»¿ä½›ä¸€å¹…å¤©ç„¶çš„æ°´å¢¨ç”»å¾å¾å±•å¼€ï¼Œé™é»˜è€Œå¤§æ°”ã€‚<br><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/adae648bbc5e37c717242a29b6eb6a4b.JPG"></p><p>ä¸‹åˆ3ç‚¹å·¦å³æˆ‘ä»¬æŠµè¾¾æ•¦ç…Œçš„é…’åº—åŠç†å…¥ä½ï¼Œç¨ä½œä¼‘æ¯åç›´å¥”é¸£æ²™å±±å’Œæœˆç‰™æ³‰ï¼Œå»è§è¯å±±æ³‰å…±å¤„ï¼Œæ²™æ°´å…±ç”Ÿçš„å¥‡è¿¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3933.jpg"></p><p>æ™šä¸Šçš„ä¸‡äººæ¼”å”±ä¼šè¿˜è¯·åˆ°äº†å‘¨æ·±ï¼Œæœ‰å¹¸è§è¯äº†ä¸€äº›ç››å¤§çš„åœºæ™¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3946.jpg"></p><p>ç¬¬äºŒå¤©æ—©ä¸Šæˆ‘ä»¬ç›´å¥”è«é«˜çªŸï¼Œå»è§è¯è¿™åº§â€œæ²™æ¼ ä¸­çš„è‰ºæœ¯å®åº“â€ã€‚è¿™åº§å¼€å‡¿äºå‰ç§¦æ—¶é—´çš„çŸ³çªŸï¼Œæœ€åˆåªæ˜¯åƒ§ä¾£ä»¬åœ¨å¤§æ¼ è¾¹ç¼˜å¼€å‡¿çš„ä¾›ä¿®è¡Œæ‰€åœ¨ã€‚ç„¶è€Œéšç€å†æœå†ä»£çš„ä¸æ–­å®Œå–„ï¼Œè«é«˜çªŸå·²ç»æˆä¸ºä¸€ä¸ªè·¨è¶Šåƒå¹´çš„è‰ºæœ¯å®åº“ã€‚</p><p>åœ¨æ˜æš—è€Œå®‰é™çš„æ´çªŸé‡Œï¼Œå£ç”»ä¸å½©å¡‘ä¾æ—§è‰²å½©æ–‘æ–“ï¼Œä»¿ä½›è·¨è¶Šåƒå¹´çš„æ—¶å…‰ä¸æˆ‘ä»¬å¯¹è§†ã€‚é‚£ä¸€å°Šå°Šä½›åƒåº„ä¸¥è€Œæ…ˆæ‚²ï¼Œå£ç”»ä¸Šçš„çº¿æ¡ä¸è‰²å½©è¯‰è¯´ç€ä¿¡ä»°ã€å•†æ—…ä¸æ–‡æ˜çš„äº¤èã€‚ç«™åœ¨è¿™é‡Œï¼Œä»¿ä½›èƒ½å¬è§å¤ä¸è·¯ä¸Šé©¼é“ƒå£°å£°ï¼Œçœ‹è§åƒå¹´å‰äººä»¬å¾€æ¥ä¸æ¯çš„èº«å½±ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3949.jpg"></p><h2 id="Day6"><a href="#Day6" class="headerlink" title="Day6"></a>Day6</h2><p>éšç€å½¢æˆè¿›å…¥å°¾å£°ï¼Œå¤§å®¶ä¹Ÿéƒ½æœ‰ç‚¹ç´¯äº†ã€‚ä»Šå¤©æˆ‘ä»¬ä¸»è¦æ˜¯ä»æ•¦ç…Œå‡ºå‘ï¼Œä¹˜åé«˜é“æ²¿ç€æ²³è¥¿èµ°å»Šåˆ°è¾¾å¼ æ–ã€‚å¼ æ–ä½œä¸ºæ²³è¥¿å››éƒ¡ä¹‹ä¸€ï¼ŒåŒæ ·æˆç«‹äºæ±‰æ­¦å¸æ—¶æœŸï¼Œå…¶åå¯“æ„â€œå¼ å›½è‡‚æ–ï¼Œä»¥é€šè¥¿åŸŸâ€ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬èµ°è¿›å¼ æ–ä¸¹éœåœ°è²Œæ™¯åŒºï¼Œå±‚å çš„å±±å³¦ä»¿ä½›æ³¼æ´’äº†ä¸ƒå½©é¢œæ–™ï¼Œèµ¤ã€æ©™ã€é»„ã€ç»¿ã€é’ã€è“ã€ç´«äº¤ç»‡æˆä¸€å¹…å£®ä¸½ç”»å·ï¼Œå®›å¦‚å¤§è‡ªç„¶çš„è°ƒè‰²æ¿ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/fengz63/picture@main/IMG_3980.jpg"></p><h2 id="Day7"><a href="#Day7" class="headerlink" title="Day7"></a>Day7</h2><p>ä»è¥¿å®å‡ºå‘è¸ä¸Šå›ç¨‹ï¼Œè‡³æ­¤ä¸ƒå¤©çš„è¡Œç¨‹åœ†æ»¡ç»“æŸã€‚ä¸€è·¯èµ°æ¥ï¼Œä»é’æµ·æ¹–çš„ç¢§æ³¢ï¼Œåˆ°å¯Ÿå°”æ±—ç›æ¹–çš„ç¿ ç»¿ï¼›ä»æ•¦ç…Œçš„åƒå¹´å£ç”»ï¼Œåˆ°å¼ æ–ä¸¹éœçš„ä¸ƒå½©å±±å³¦ï¼›ä»é»‘ç‹¬å±±çš„æ°´å¢¨è‹å‡‰ï¼Œåˆ°æ²³è¥¿èµ°å»Šçš„å†å²åšé‡â€¦â€¦æ¯ä¸€å¤„é£æ™¯éƒ½åœ¨å¿ƒåº•ç•™ä¸‹äº†æ·±æ·±çš„çƒ™å°ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;2025å¹´çš„4æœˆä»½å¯¹æˆ‘æ¥è¯´æ˜¯å¼‚å¸¸è‰°éš¾çš„ï¼Œä¸ä»…è¦å®Œæˆå½“å‰çš„å·¥ä½œï¼Œè¿˜è¦é¡¶ç€å‹åŠ›å»é¢è¯•æ–°çš„å…¬å¸ã€‚ç„¶è€Œå¯èƒ½æ˜¯å› ä¸ºç¬¬ä¸€ä»½å·¥ä½œçš„æ–¹å‘è¿‡äºåº•å±‚ï¼Œå¾ˆå¤šå…¬å¸æ²¡æœ‰è¿™ä¸ªæ–¹å‘ï¼Œå¯¼è‡´æ‰¾å·¥ä½œå¼‚å¸¸è‰°è¾›ã€‚å‰åŠä¸ªæœˆåŸºæœ¬æ²¡æœ‰è¿›å…¥ç¬¬äºŒè½®é¢è¯•çš„ï¼Œéƒ½æ˜¯ä¸€è½®é¢è¯•å®Œå°±å¤±è´¥äº†ã€‚å¥½åœ¨æ²¡æœ‰è¢«æŒ«æŠ˜æ‰“è´¥ï¼ŒåšæŒä¸æ–­çš„å»å°è¯•æ–°å…¬å¸ï¼Œæ–°éƒ¨é—¨ï¼Œç»ˆäºåœ¨4æœˆåº•æ—¶å€™è¿æ¥äº†å¥½æ¶ˆæ¯ï¼Œé¾™èŠ¯ä¸­ç§‘å’Œå­—èŠ‚è·³åŠ¨å…ˆåæ‹¿åˆ°äº†æ„å‘ä¹¦ï¼Œç®—æ˜¯å¯ä»¥ç¨å¾®å–˜å£æ°”äº†ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ—…è¡Œ" scheme="http://zfeng.github.io/categories/%E6%97%85%E8%A1%8C/"/>
    
    
    <category term="æ—…è¡Œ" scheme="http://zfeng.github.io/tags/%E6%97%85%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu 24.04 é…ç½® Prometheus å’Œ Grafana ç›‘æ§</title>
    <link href="http://zfeng.github.io/article/4c19da53a46d/"/>
    <id>http://zfeng.github.io/article/4c19da53a46d/</id>
    <published>2025-08-10T07:23:47.000Z</published>
    <updated>2025-08-27T14:14:59.446Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å·¥ä½œä¸­ä½¿ç”¨äº† prometheus æ•°æ®é‡‡é›†åç«¯ï¼Œå¹¶æ­é… grafana å®ç°å¯¹æœºå™¨å¾—ç›‘æ§ã€‚ä½¿ç”¨è¿‡ç¨‹ä¸­æ„Ÿè§‰åŠŸèƒ½éå¸¸å¼ºå¤§çµæ´»ï¼Œäºæ˜¯è¶ç€å‘¨æœ«ç»™è‡ªå·±å®¶é‡Œçš„NASä¸Šè£…äº†ä¸€ä¸ªprometheusæ•°æ®ï¼Œåœ¨ç”¨grafanaé…åˆå®Œæˆå¯¹ä¸ªäººNASçš„æ€§èƒ½ç›‘æ§ã€‚</p><span id="more"></span><h2 id="åœ¨å®¿ä¸»æœºä¸Šå®‰è£…-Prometheus"><a href="#åœ¨å®¿ä¸»æœºä¸Šå®‰è£…-Prometheus" class="headerlink" title="åœ¨å®¿ä¸»æœºä¸Šå®‰è£… Prometheus"></a>åœ¨å®¿ä¸»æœºä¸Šå®‰è£… Prometheus</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>Ubuntu é»˜è®¤çš„æºé‡Œé¢å°±æœ‰ prometheus çš„å®‰è£…åŒ…ï¼Œå› æ­¤å®‰è£…å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install prometheus</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ prometheus ç›¸å…³æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl status prometheus</span></span><br><span class="line">â— prometheus.service - Monitoring system and <span class="keyword">time</span> series database</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/prometheus.service; enabled; preset: enabled)</span><br><span class="line">     Active: active (running) since Sun 2025-08-10 09:50:12 CST; 5h 4min ago</span><br><span class="line">       Docs: https://prometheus.io/docs/introduction/overview/</span><br><span class="line">             man:prometheus(1)</span><br><span class="line">   Main PID: 1270424 (prometheus)</span><br><span class="line">      Tasks: 11 (<span class="built_in">limit</span>: 9223)</span><br><span class="line">     Memory: 111.7M (peak: 148.7M)</span><br><span class="line">        CPU: 2min 2.878s</span><br><span class="line">     CGroup: /system.slice/prometheus.service</span><br><span class="line">             â””â”€1270424 /usr/bin/prometheus</span><br><span class="line"></span><br><span class="line">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.181Z <span class="built_in">caller</span>=compact.go:523 level=info component=tsdb msg=<span class="string">&quot;write block&quot;</span> &gt;</span><br><span class="line">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.188Z <span class="built_in">caller</span>=head.go:1293 level=info component=tsdb msg=<span class="string">&quot;Head GC complet&gt;</span></span><br><span class="line"><span class="string">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.391Z caller=compact.go:464 level=info component=tsdb msg=&quot;</span>compact block&gt;</span><br><span class="line">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.397Z <span class="built_in">caller</span>=db.go:1617 level=info component=tsdb msg=<span class="string">&quot;Deleting obsolete&gt;</span></span><br><span class="line"><span class="string">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.402Z caller=db.go:1617 level=info component=tsdb msg=&quot;</span>Deleting obsolete&gt;</span><br><span class="line">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.406Z <span class="built_in">caller</span>=db.go:1617 level=info component=tsdb msg=<span class="string">&quot;Deleting obsolete&gt;</span></span><br><span class="line"><span class="string">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.714Z caller=compact.go:464 level=info component=tsdb msg=&quot;</span>compact block&gt;</span><br><span class="line">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.722Z <span class="built_in">caller</span>=db.go:1617 level=info component=tsdb msg=<span class="string">&quot;Deleting obsolete&gt;</span></span><br><span class="line"><span class="string">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.729Z caller=db.go:1617 level=info component=tsdb msg=&quot;</span>Deleting obsolete&gt;</span><br><span class="line">8æœˆ 10 13:00:05 zfeng prometheus[1270424]: ts=2025-08-10T05:00:05.736Z <span class="built_in">caller</span>=db.go:1617 level=info component=tsdb msg=<span class="string">&quot;Deleting obsolete&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°prometheusçš„æ§åˆ¶ç«¯å£æ˜¯9090ã€‚æ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­è®¿é—®æœåŠ¡å™¨ipå’Œ9090ç«¯å£ï¼Œå¦‚æœ prometheus é¡µé¢å¯ä»¥æ­£å¸¸æ‰“å¼€å°±è¯´æ˜å®‰è£…å®Œæˆï¼š</p><p><img src="/images/prometheus_web_ui.png"></p><h2 id="åœ¨è¢«ç›‘æ§èŠ‚ç‚¹å®‰è£…-node-exporter"><a href="#åœ¨è¢«ç›‘æ§èŠ‚ç‚¹å®‰è£…-node-exporter" class="headerlink" title="åœ¨è¢«ç›‘æ§èŠ‚ç‚¹å®‰è£… node-exporter"></a>åœ¨è¢«ç›‘æ§èŠ‚ç‚¹å®‰è£… node-exporter</h2><p>ä¹Ÿæ˜¯ç›´æ¥ä»ubuntuæºå®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install prometheus-node-exporter</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ node-exporter æœåŠ¡æœ‰æ²¡æœ‰å¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl status prometheus-node-exporter</span></span><br><span class="line">â— prometheus-node-exporter.service - Prometheus exporter <span class="keyword">for</span> machine metrics</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/prometheus-node-exporter.service; enabled; preset: enabled)</span><br><span class="line">     Active: active (running) since Sat 2025-08-09 18:30:39 CST; 20h ago</span><br><span class="line">       Docs: https://github.com/prometheus/node_exporter</span><br><span class="line">   Main PID: 1221924 (prometheus-node)</span><br><span class="line">      Tasks: 6 (<span class="built_in">limit</span>: 9223)</span><br><span class="line">     Memory: 10.6M (peak: 12.2M)</span><br><span class="line">        CPU: 24min 7.150s</span><br><span class="line">     CGroup: /system.slice/prometheus-node-exporter.service</span><br><span class="line">             â””â”€1221924 /usr/bin/prometheus-node-exporter <span class="string">&quot;--collector.filesystem.ignored-mount-points=^/(sys|proc|dev|run)(\$|/)&quot;</span> <span class="string">&quot;--coll&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.940Z caller=node_exporter.go:117 level=info collector=the&gt;</span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.940Z caller=node_exporter.go:117 level=info collector=time</span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.940Z caller=node_exporter.go:117 level=info collector=tim&gt;</span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.940Z caller=node_exporter.go:117 level=info collector=udp&gt;</span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.940Z caller=node_exporter.go:117 level=info collector=una&gt;</span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.940Z caller=node_exporter.go:117 level=info collector=vms&gt;</span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.940Z caller=node_exporter.go:117 level=info collector=xfs</span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.940Z caller=node_exporter.go:117 level=info collector=zfs</span></span><br><span class="line"><span class="string">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.941Z caller=tls_config.go:313 level=info msg=&quot;</span>Listening o&gt;</span><br><span class="line">8æœˆ 09 18:30:39 zfeng prometheus-node-exporter[1221924]: ts=2025-08-09T10:30:39.941Z <span class="built_in">caller</span>=tls_config.go:316 level=info msg=<span class="string">&quot;TLS is disa&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° node-exporter ç›‘æ§çš„ç«¯å£å·æ˜¯ 9100ã€‚</p><h2 id="é…ç½®ç›‘æ§æœºçš„-prometheus-xml-åŠ å…¥è¢«ç›‘æ§çš„èŠ‚ç‚¹"><a href="#é…ç½®ç›‘æ§æœºçš„-prometheus-xml-åŠ å…¥è¢«ç›‘æ§çš„èŠ‚ç‚¹" class="headerlink" title="é…ç½®ç›‘æ§æœºçš„ prometheus.xml åŠ å…¥è¢«ç›‘æ§çš„èŠ‚ç‚¹"></a>é…ç½®ç›‘æ§æœºçš„ prometheus.xml åŠ å…¥è¢«ç›‘æ§çš„èŠ‚ç‚¹</h2><p>æ‰“å¼€<code>/etc/prometheus/prometheus.yml</code>æ–‡ä»¶ï¼Œç¼–è¾‘å¯¹åº”ä½ç½®ï¼ŒåŠ å…¥èŠ‚ç‚¹é…ç½®ï¼Œå¦‚ä¸‹ï¼š<br><img src="/images/prometheus_server_config.png"><br>ç„¶åé‡å¯æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart prometheus</span><br></pre></td></tr></table></figure><p>å†æ‰“å¼€ prometheus çš„ç›‘æ§åˆ—è¡¨ï¼Œå‘ç°å·²æœ‰ä¸¤ä¸ªèŠ‚ç‚¹è¢«ç›‘æ§äº†ï¼ŒåŒ…æ‹¬ç›‘æ§æœºæœ¬èº«ï¼š</p><p><img src="/images/prometheus_web_ui_2.png"></p><h2 id="å®‰è£…-Grafana"><a href="#å®‰è£…-Grafana" class="headerlink" title="å®‰è£… Grafana"></a>å®‰è£… Grafana</h2><p>Ubuntu é»˜è®¤æºä¸­æ²¡æœ‰ grafana çš„å®‰è£…åŒ…ï¼Œå› æ­¤éœ€è¦æ·»åŠ å¯¹åº”çš„æºã€‚å›½å†…å¯ä»¥ç”¨æ¸…åæºä»£æ›¿ï¼Œè¯¦ç»†è§ï¼š<a href="https://mirrors.tuna.tsinghua.edu.cn/help/grafana/">æ·»åŠ  Grafana è½¯ä»¶ä»“åº“</a></p><p>å®‰è£…å®Œåæ£€æŸ¥æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl status grafana-server</span></span><br><span class="line">â— grafana-server.service - Grafana instance</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/grafana-server.service; disabled; preset: enabled)</span><br><span class="line">     Active: active (running) since Sat 2025-08-09 18:00:09 CST; 21h ago</span><br><span class="line">       Docs: http://docs.grafana.org</span><br><span class="line">   Main PID: 1219957 (grafana)</span><br><span class="line">      Tasks: 19 (<span class="built_in">limit</span>: 9223)</span><br><span class="line">     Memory: 122.9M (peak: 158.3M)</span><br><span class="line">        CPU: 11min 21.470s</span><br><span class="line">     CGroup: /system.slice/grafana-server.service</span><br><span class="line">             â””â”€1219957 /usr/share/grafana/bin/grafana server --config=/etc/grafana/grafana.ini --pidfile=/run/grafana/grafana-server.pid &gt;</span><br><span class="line"></span><br><span class="line">8æœˆ 10 15:00:22 zfeng grafana[1219957]: logger=cleanup t=2025-08-10T15:00:22.049771001+08:00 level=info msg=<span class="string">&quot;Completed cleanup jobs&quot;</span> dura&gt;</span><br><span class="line">8æœˆ 10 15:00:23 zfeng grafana[1219957]: logger=plugins.update.checker t=2025-08-10T15:00:23.431751891+08:00 level=info msg=<span class="string">&quot;Update check &gt;</span></span><br><span class="line"><span class="string">8æœˆ 10 15:01:28 zfeng grafana[1219957]: logger=infra.usagestats t=2025-08-10T15:01:28.986667313+08:00 level=info msg=&quot;</span>Usage stats are rea&gt;</span><br><span class="line">8æœˆ 10 15:10:22 zfeng grafana[1219957]: logger=cleanup t=2025-08-10T15:10:22.020334022+08:00 level=info msg=<span class="string">&quot;Completed cleanup jobs&quot;</span> dura&gt;</span><br><span class="line">8æœˆ 10 15:10:23 zfeng grafana[1219957]: logger=plugins.update.checker t=2025-08-10T15:10:23.51111745+08:00 level=info msg=<span class="string">&quot;Update check s&gt;</span></span><br><span class="line"><span class="string">8æœˆ 10 15:20:22 zfeng grafana[1219957]: logger=cleanup t=2025-08-10T15:20:22.022565084+08:00 level=info msg=&quot;</span>Completed cleanup <span class="built_in">jobs</span><span class="string">&quot; dura&gt;</span></span><br><span class="line"><span class="string">8æœˆ 10 15:20:23 zfeng grafana[1219957]: logger=plugins.update.checker t=2025-08-10T15:20:23.415660356+08:00 level=info msg=&quot;</span>Update check &gt;</span><br><span class="line">8æœˆ 10 15:30:22 zfeng grafana[1219957]: logger=cleanup t=2025-08-10T15:30:22.047368654+08:00 level=info msg=<span class="string">&quot;Completed cleanup jobs&quot;</span> dura&gt;</span><br><span class="line">8æœˆ 10 15:30:23 zfeng grafana[1219957]: logger=plugins.update.checker t=2025-08-10T15:30:23.469371479+08:00 level=info msg=<span class="string">&quot;Update check &gt;</span></span><br><span class="line"><span class="string">8æœˆ 10 15:31:28 zfeng grafana[1219957]: logger=infra.usagestats t=2025-08-10T15:31:28.98688322+08:00 level=info msg=&quot;</span>Usage stats are <span class="built_in">read</span>&gt;</span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹æ˜¯å·²ç»å¯åŠ¨çš„ï¼Œå¦‚æœæ²¡å¯åŠ¨ï¼Œæ‰‹åŠ¨å¯åŠ¨å°±å¥½ã€‚grafana æœåŠ¡é»˜è®¤ç›‘æ§ç«¯å£æ˜¯ 3000ï¼Œä»æµè§ˆå™¨ä¸­è¾“å…¥ ip:3000ï¼Œå¦‚æœèƒ½æ˜¾ç¤º grafana é¡µé¢è¡¨ç¤ºä¸€åˆ‡æ­£å¸¸ã€‚</p><h2 id="é…ç½®-Grafana"><a href="#é…ç½®-Grafana" class="headerlink" title="é…ç½® Grafana"></a>é…ç½® Grafana</h2><p>Grafana é»˜è®¤çš„è´¦å·å’Œå¯†ç éƒ½æ˜¯ adminï¼Œå…ˆç™»å½•ã€‚</p><h3 id="æ·»åŠ æ•°æ®æº"><a href="#æ·»åŠ æ•°æ®æº" class="headerlink" title="æ·»åŠ æ•°æ®æº"></a>æ·»åŠ æ•°æ®æº</h3><p>æ‰“å¼€ Web UIï¼Œè¿›å…¥ï¼š<code>Connections-&gt;Data Sources</code>ï¼Œç‚¹å‡» <code>Add new data source</code> æŒ‰é’®:<br><img src="/images/grafana_1.png"><br>é€‰æ‹© Prometheusï¼š<br><img src="/images/grafana_2.png"><br>ä¿®æ”¹ Connection é€‰é¡¹ä¸­å¯¹åº”çš„åœ°å€ï¼Œæ”¹ä¸º prometheus server å¯¹åº”çš„åœ°å€å³å¯ã€‚<br><img src="/images/grafana_3.png"></p><h3 id="æ·»åŠ -Dashboard"><a href="#æ·»åŠ -Dashboard" class="headerlink" title="æ·»åŠ  Dashboard"></a>æ·»åŠ  Dashboard</h3><p>Dashboard æ·»åŠ æœ‰ç°æˆçš„æ¨¡ç‰ˆï¼Œå¯ä»¥å»è¿™é‡Œæ‰¾ï¼š<a href="https://grafana.com/grafana/dashboards/?search=8919">https://grafana.com/grafana/dashboards/?search=8919</a>ã€‚</p><p><img src="/images/grafana_dashboard.png"></p><p>é€‰æ‹© Linux ä¸»æœºè¯¦æƒ…ä¸‹è½½å¯¹åº”çš„jsonæ–‡ä»¶å³å¯ã€‚</p><p>ä¸‹è½½å®Œæˆååœ¨ grafana Web UI ä¸­<code>New-&gt;Import</code>é€‰æ‹©åˆšæ‰ä¸‹è½½çš„ json æ–‡ä»¶å³å¯å¾—åˆ°ä¸€ä¸ªæ¯”è¾ƒå®Œå–„çš„ Linux ä¸»æœºè¯¦æƒ…ç›‘æ§é¢æ¿äº†ï¼š</p><p><img src="/images/grafana_dashboard_2.png"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ€è¿‘å·¥ä½œä¸­ä½¿ç”¨äº† prometheus æ•°æ®é‡‡é›†åç«¯ï¼Œå¹¶æ­é… grafana å®ç°å¯¹æœºå™¨å¾—ç›‘æ§ã€‚ä½¿ç”¨è¿‡ç¨‹ä¸­æ„Ÿè§‰åŠŸèƒ½éå¸¸å¼ºå¤§çµæ´»ï¼Œäºæ˜¯è¶ç€å‘¨æœ«ç»™è‡ªå·±å®¶é‡Œçš„NASä¸Šè£…äº†ä¸€ä¸ªprometheusæ•°æ®ï¼Œåœ¨ç”¨grafanaé…åˆå®Œæˆå¯¹ä¸ªäººNASçš„æ€§èƒ½ç›‘æ§ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æŠ€æœ¯" scheme="http://zfeng.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="æŠ€æœ¯" scheme="http://zfeng.github.io/tags/%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>é‡åº†ä¹‹è¡Œ</title>
    <link href="http://zfeng.github.io/article/d8644e889782/"/>
    <id>http://zfeng.github.io/article/d8644e889782/</id>
    <published>2025-01-02T21:02:20.000Z</published>
    <updated>2025-08-21T14:30:38.298Z</updated>
    
    <content type="html"><![CDATA[<p>2024å¹´12æœˆ21æ—¥å’Œ22æ—¥è¿›è¡Œäº†ä¸ºæœŸä¸¤å¤©çš„é‡åº†ä¹‹è¡Œã€‚</p><span id="more"></span><p>æ—©ä¸Š6ç‚¹45çš„é£æœºè®©æˆ‘ä¸€å¤§æ—©èµ·æ¥å¼€è½¦å»æœºåœºï¼Œåœè½¦ã€å®‰æ£€ã€å€™æœºï¼Œç­‰ååœ¨é£æœºä¸Šé‚£ä¸€åˆ»å·²ç»æ˜¯6ç‚¹15äº†ï¼Œè™½ç„¶éå¸¸å›°ï¼Œä½†æ˜¯æƒ³ç€é©¬ä¸Šå¯ä»¥å»è‡ªå·±æƒ³å»çš„åœ°æ–¹è¿˜æ˜¯è›®å¼€å¿ƒçš„ã€‚<br>é£æœºä¸Šçœ‹åˆ°äº†éå¸¸å£®è§‚çš„äº‘å±‚<br><img src="/images/chongqing_20231221_1.jpg"></p><p>æ™šä¸Šåƒå®Œç«é”…ååœ¨åƒæ–¯é—¨å¤§æ¡¥æ—è¾¹çœ‹åˆ°äº†ç¾ä¸½çš„å¤œæ™¯<br><img src="/images/chongqing_20231221_2.jpg"></p><p>æ²¿æ±Ÿè¾¹æ¼«æ­¥ï¼Œæ„Ÿè§‰éå¸¸çš„æƒ¬æ„èˆ’é€‚ï¼Œä¸å¾—ä¸è¯´ï¼Œé‡åº†ç›¸å¯¹äºæ­å·æ¥è¯´è¿˜æ˜¯éå¸¸é€‚åˆç”Ÿæ´»çš„ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;2024å¹´12æœˆ21æ—¥å’Œ22æ—¥è¿›è¡Œäº†ä¸ºæœŸä¸¤å¤©çš„é‡åº†ä¹‹è¡Œã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ—…è¡Œ" scheme="http://zfeng.github.io/categories/%E6%97%85%E8%A1%8C/"/>
    
    
    <category term="æ—…è¡Œ" scheme="http://zfeng.github.io/tags/%E6%97%85%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>æ–°å¹´å¿«ä¹</title>
    <link href="http://zfeng.github.io/article/6b4a87f41aa8/"/>
    <id>http://zfeng.github.io/article/6b4a87f41aa8/</id>
    <published>2025-01-01T15:24:09.000Z</published>
    <updated>2025-08-21T14:30:38.281Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ–°å¹´ç¬¬ä¸€å¤©"><a href="#æ–°å¹´ç¬¬ä¸€å¤©" class="headerlink" title="æ–°å¹´ç¬¬ä¸€å¤©"></a>æ–°å¹´ç¬¬ä¸€å¤©</h3><p>ä»Šå¤©æ˜¯2025å¹´1æœˆ1æ—¥ï¼Œæ–°å¹´çš„ç¬¬ä¸€å¤©ï¼Œä»Šå¤©å¼€å§‹æ‰“ç®—ç»´æŠ¤ä¸€ä¸ªè‡ªå·±çš„åšå®¢ï¼Œè¿™æ˜¯å¼€å§‹ã€‚<br>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ–°çš„ä¸€å¹´ï¼Œå¸Œæœ›äº‹äº‹é¡ºå¿ƒï¼Œæ–°å¹´å¿«ä¹ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æ–°å¹´ç¬¬ä¸€å¤©&quot;&gt;&lt;a href=&quot;#æ–°å¹´ç¬¬ä¸€å¤©&quot; class=&quot;headerlink&quot; title=&quot;æ–°å¹´ç¬¬ä¸€å¤©&quot;&gt;&lt;/a&gt;æ–°å¹´ç¬¬ä¸€å¤©&lt;/h3&gt;&lt;p&gt;ä»Šå¤©æ˜¯2025å¹´1æœˆ1æ—¥ï¼Œæ–°å¹´çš„ç¬¬ä¸€å¤©ï¼Œä»Šå¤©å¼€å§‹æ‰“ç®—ç»´æŠ¤ä¸€ä¸ªè‡ªå·±çš„åšå®¢ï¼Œè¿™æ˜¯å¼€å§‹ã€‚&lt;br&gt;ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ–°çš„ä¸€å¹´ï¼Œå¸Œæœ›</summary>
      
    
    
    
    <category term="ç”Ÿæ´»" scheme="http://zfeng.github.io/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="ç”Ÿæ´»" scheme="http://zfeng.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
</feed>
